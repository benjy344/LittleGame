<div class="loading  in">
  
</div>
<% 
@count_objet = 0
@count_monster = 0
@donjon.rooms.each do |r| 
  @count_objet = @count_objet + r.objets.count
  @count_monster = @count_monster + r.monsters.count
end %>
<div id="bag">
  <div class="open-button js-open-button">
    <div class="button-burger">
        <button class="js-hamburger hamburger hamburger--spin" type="button">
            <span class="hamburger-box">
                <span class="hamburger-inner"></span>
            </span>
        </button>
    </div>
  </div>
  <div class="js-objects inventaire">
    <h2>Inventaire</h2>
    <div class="js-money"><span>Or:</span><span class="renderGold"> <%= current_user.avatar.money %></span></div>
      <div class="js-content-objects">
        <%= render partial: 'objets/objets_list' , locals: {objets: @avatar.objets, scope: current_user.avatar}%>
      </div>
  </div><!--
  --><div class="js-craft-buttons craft-buttons">
    <h2>Craft</h2>
    <div class="js-content-craft">
      <%= render partial: 'avatars/craft' , locals: {avatar: @avatar}%>
    </div>
  </div>
</div>

<div class="js-rooms-container rooms-container">
  <article class="js-article">
    <div class="room js-room intro-room js-room-0">
      <h2><%= @donjon.name%></h2>
      <p>Nombre d'étages : <%= @donjon.rooms.count %></p>
      <p>Nombre d'objets : <%= @count_objet %></p>
      <p>Nombre de monstres : <%= @count_monster %></p>
      <div class="btn nxt btn--white">Entrer</div>
      <%= link_to 'Sortir', donjons_path, class: "btn exit btn--white" %>
    </div>
  </article>
  <%= render partial: 'rooms/rooms_list' , locals: {rooms: @donjon.rooms}%>
  <article class="js-article">
    <div class="room js-room intro-room js-room-<%= @donjon.rooms.count + 1 %>">
      <p>Il y a une lumière au bout ...</p>
      <%= link_to 'Sortir', {controller: "avatars", action: "finishDonjon", donjon_id: @donjon.id }, class: " btn btn--white" %>
    </div>
  </article>
</div>

<div class="avatar-controller js-avatar-controller">
  <span class="name"><%= current_user.avatar.name %></span>
  <span class="level">Lvl : <%= current_user.avatar.level %></span>
  <div class="currsors">
    <div class="js-avatar-hp avatar-hp" data-hpMax="<%= current_user.avatar.MaxHealth %>">
      <div class="js-avatar-current-hp avatar-current-hp" data-hp="<%= current_user.avatar.hp %>"></div>
      <span class="js-hpcount hpcount">PV : <%= current_user.avatar.hp %>/<%= current_user.avatar.MaxHealth %></span>
    </div>
    <div class="js-avatar-exp avatar-exp" data-next-level="<%= current_user.avatar.nextLevel %>">
      <div class="js-avatar-current-exp avatar-current-exp" data-exp="<%= current_user.avatar.exp %>"></div>
      <span class="js-expcount expcount">Exp : <%= current_user.avatar.exp %>/<%= current_user.avatar.nextLevel %></span>
    </div>
  </div>
  
  
  <div class="carac">
    <span class="js-agility">Agilité : <%= current_user.avatar.agility %></span>
    <span class="js-force">Force : <%= current_user.avatar.force %><% if current_user.avatar.id_objet_equipe != 0 && !current_user.avatar.id_objet_equipe.nil?%> + <%= current_user.avatar.objets.find(current_user.avatar.id_objet_equipe).force %> <%end%></span>
    <span class="js-intéligence">Intelligence : <%= current_user.avatar.inteligence %></span>
    <span class="js-defence">Défence : <%= current_user.avatar.defence %><% if current_user.avatar.id_defObject != 0 && !current_user.avatar.id_defObject.nil? %> + <%= current_user.avatar.objets.find(current_user.avatar.id_defObject).force %> <%end%></span>
  </div>
  <div class="family">
    <span class="js-job">Classe : <%= current_user.avatar.job.name %></span>
    <span class="js-type">Type : <%= current_user.avatar.element %></span>
  </div>
  

  <div class="render-avatar">
    <%= render partial: 'avatars/avatar' , locals: {avatar: @avatar}%>
  </div>
</div>